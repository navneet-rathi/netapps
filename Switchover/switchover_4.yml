---
- name: Oracle database and GoldenGate Switchover on Solaris
  hosts: dr_db:dc_db
  become: yes
  become_user: "{{ oracle_user }}"
  gather_facts: no
  environment: "{{ ogg_env }}"
  serial: 1
  vars_files:
    - oracle_gp_vars.yml
  tasks:
    - name: sw4 |Open New primary in RW | Need to execute on ALL hosts in Standby
      ansible.builtin.shell: |
        . ~/.bash_profile
        cd {{ oracle_home }}/.bash_profile && sqlplus -S / as sysdba <<EOF
        ALTER DATABASE OPEN;
        EXIT;
        EOF
      args:  
        executable: /bin/bash  
      when: "'dr_db' in group_names"

    - name: sw1 | Job Queue process to 0 | No more schedular jobs will RUN on DB
      ansible.builtin.shell: |
        . ~/.bash_profile && sqlplus -S / as sysdba <<EOF
        ALTER SYSTEM SET JOB_QUEUE_PROCESSES=100 SID='*';
        EXIT;
        EOF
      args:  
        executable: /bin/bash 
          #      when: "'dc_db_1' in group_names"
      when: inventory_hostname == "dr_db_1"
